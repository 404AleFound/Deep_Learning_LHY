**Machine Learning = Looking for Function**

<img src="./assets/机器学习的本质.png" alt="image-20250720191218020" style="zoom:50%;" />

Different types of Functions

Regression（回归）：The function outputs a scalar.

Classification（分类）：Given options, the function outputs the correct one.

Structured Learning（结构学习）：Create something with structure (image, document)

<img src="./assets/image-20250720210622033.png" alt="image-20250720210622033" style="zoom:50%;" />

在对未知函数进行猜测时，往往需要根据相关的领域知识（domain knowledge）对行数进行一个初步猜测

**步骤2：定义损失函数**

损失（loss）指的是模型预测值和真实值之间的差距，模型往往需要根据损失来进行参数优化。真实值也可以称为标签（label）。

常见的损失函数（loss function）有平均绝对误差（Mean Absolute Error， MAE）、均方误差（Mean Squared Error， MSE）和交叉熵误差（Cross Entropy）等等。
$$
e_i = |\hat{y}-y|,MAE=\frac{1}{n}\sum_{i=1}^{n}e_i
\\
e_i = (\hat{y}-y)^2,MSE=\frac{1}{n}\sum_{i=1}^{n}e_i
$$
选择不同的权重和偏置后计算模型的损失，就可以画出误差表面（error surface）的等高线图。颜色越接近蓝色就说明损失越小，越接近红色说明损失越大。

<img src="./assets/image-20250720213027857.png" alt="image-20250720213027857" style="zoom:50%;" />

**步骤3：优化问题求解**

在求解使得损失最小的模型参数时，常用的算法是梯度下降算法（gradient descent）。

首先，随机选取一个初始参数点$\omega^0$

然后，计算该点处斜率$\frac{\partial L}{\partial w}|_{w=w^0}$，并更新参数。
$$
\omega_1 = \omega^0-\eta\frac{\partial L}{\partial w}|_{w=w^0}
$$
其次，重复上述操作。当更新次数达到预期设定的上限或达到一个极值点梯度为0时，更新停止。参数$\eta$称为学习率，影响参数更新的步幅大小。学习率是自己设定的，学习率大每次参数更新的就多，学习更快，反之则慢。这种在做机器学习时，需要自己设定而不是机器自动设定的参数称为超参数（hyperparameter）。

<center class="half">
    <img src="./assets/image-20250720214913821.png" alt="image-20250720214913821" style="zoom:50%;" />
    <img src="./assets/image-20250720215028074.png" alt="image-20250720215028074" style="zoom:50%;" />
    <img src="./assets/image-20250720215113631.png" alt="image-20250720215113631" style="zoom:50%;" />
    <img src="./assets/image-20250720215145327.png" alt="image-20250720215145327" style="zoom:50%;" />
</center>

使用普通的线性函数，拟合结果如下：

![image-20250720220426594](./assets/image-20250720220426594.png)

可以看到：蓝色的线几乎就是红色的线往右平移一天而已，这很合理。因为 $x_1 $也就是前一天的观看人次，要怎么拿前一天的观看人次，去预测隔天的观看人次呢。由于采用线性函数拟合，即前一天观看人次乘以 0.97，加上 100 加上100，就是隔天的观看人次。机器几乎就是拿前一天的观看人次来预测隔天的观看人次。

然而......

<img src="./assets/image-20250720220156228.png" alt="image-20250720220156228" style="zoom:50%;" />

需要更加复杂的函数去拟合复杂的情况。

考虑多个线性分段函数拟合













